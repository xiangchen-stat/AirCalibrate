# AirCalibrate

Author: Xiang Chen
Advisor: Abhirup Datta

Department of Biostatistics
Bloomberg School of Public Health
Johns Hopkins University

## Overview

This repository provides all the code and data to reproduce the ScM Thesis *Evaluating Machine Learning Methods for Calibrating Low-Cost PM<sup>2.5</sup> Sensor Data*.

## Instructions

To run all of the analysis, you need to download all of the files in this repo and keep the folder structures to avoid potiential errors when saving results. It is recommended to open the `/AirCalibrate.Rproj` file to start a new R session and then open `/code/main.R` if you use Rstudio. You need to install `pacman` package before using `p_load()` function to install and load other required packages. When you begin the analysis, please make sure the current working directory of R is at home directory of this repository (`/AirCalibrate/`).

**Note 1: You may need 50G memory or more to run all the analysis at once. It may take around 50 hours to finish which depends on the system you use.**

**Note 2: The code is originally designed to be modulized to reduce the need for memory and time to run it. You can utilize this design by uncommented all of the code lines including `save()` and `load()` functions in the `main.R` file. After doing that, you only need to run all the code once and then you can run each section independently. The "section" is means level 1 heading in the code, such as 1., 2., 3., etc.** 

The structure of this repository is as follows: 

* `code`: R code (`main.R`) to import, wrangle, visualize, analyze, and save data.
* `data`: including `raw`, `tidy`, `plot`, and `model` data.
	* `raw`: including raw PM<sup>2.5</sup> and meterological data downloaded directly from [EPA AQS](https://aqs.epa.gov/aqsweb/airdata/download_files.html) and [PurpleAir low-cost](https://www2.purpleair.com/). The EPA data is under `EPA` subfolder and named `hourly_88101_2019.zip` and `hourly_88101_2019.zip`. The PurpleAir data is under `CA` subfolder named `CA.zip`.
	* `tidy`: This folder includes `.RData` files generated during the analysis. These data files will be loaded in later parts of the code. It is also the basis of the modulized design.
	* `plot`: This folder includes `.RData` files related to making plots generated during the analysis. 
	* `model`: This folder includes `.RData` files related to modeling generated during the analysis. 
* `figures`: including `map`, `EDA`, and `mba` subfolders.
	* `map`: including generated map plots in png format.
	* `EDA`: including plots related to exploratory analysis in png format.
	* `mba`: including PM<sup>2.5</sup> concentration maps generated by [mba package](https://cran.r-project.org/web/packages/MBA/index.html) in png format.
* `results`: including model evaluation results.



